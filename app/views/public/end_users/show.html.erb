<div class="container">
  <div class="row m-4">
    <h2><i class="fas fa-user"></i>&nbsp;マイページ</h2>
  </div>

  <div class="row justify-content-around">
    <div class="col-md-3">

      <%= image_tag @end_user.get_profile_image(220, 220), class:"d-block mx-auto img-thumbnail" %>

      <div class="row justify-content-center mt-3">
        <div>
          <span><i class="fas fa-bookmark"></i><%= link_to "ブックマーク(#{@end_user.bookmarks.count})",bookmark_end_user_path(@end_user) %>&nbsp;</span>
          <span class="favorite-count"><%= render 'public/relationships/favorite_count', end_user: @end_user %></span>
        </div>
      </div>

      <div class="row justify-content-center mt-3">
        <% unless current_end_user.guest_user? %>
          <div class="col-md-10 text-center">
            <% if @end_user == current_end_user %>
              <%= link_to '編集する', edit_end_user_path(@end_user), class: "btn btn-success my-2", style:"width: 100%" %>
              <%= link_to  notifications_path, class: "btn btn-outline-danger my-2", style:"width: 100%" do %>
                <% if unchecked_notifications.any? %>
                  新着メッセージが届いています！
                <% else %>
                  新着メッセージはありません
                <% end %>
              <% end %>
            <% end %>
          </div>
          <div class="col-md-10 text-center" id="favorite-buttons-<%= @end_user.id %>">
            <%= render "public/relationships/favorite_btn", end_user: @end_user %>
          </div>
        <% end %>
      </div>


    </div>

    <div class="col-md-8 border rounded-lg">
      <table class="table table-borderless table-sm m-3">
        <tr>
          <th class="col-md-3">名前</th>
          <td><%= @end_user.last_name %><%= @end_user.first_name %></td>
        </tr>
        <tr>
          <th>ニックネーム</th>
          <td><%= @end_user.nickname %></td>
       </tr>
        <tr>
          <th>年齢</th>
          <td><%= (@end_user.age).to_s + "歳" %></td>
        </tr>
        <tr>
          <th>性別</th>
          <td><%= @end_user.sex_i18n %></td>
        </tr>
        <tr>
          <th>主な活動エリア</th>
          <td><%= @end_user.activity_area_i18n %></td>
        </tr>
        <tr>
          <th>マイタグ</th>
          <td>
            <% @end_user.personal_tags.each do |personal_tag| %>
              &nbsp;<%= link_to "#{"#" + personal_tag.name}", search_personal_tag_end_user_path(personal_tag) %>
            <% end %>
          </td>
        </tr>
        <tr>
          <th>自己紹介</th>
          <td><%= safe_join(@end_user.introduction.split("\n"), tag(:br)) %></td>
        </tr>
      </table>
    </div>
  </div>

  <div class="container">
    <div class="row mt-4">
      <div class="col-md-3">
        <h4 class="ml-5">所属コミュニティ</h4>
      </div>
    </div>

    <div class="row mt-3">
      <% @end_user.communities.each do |community| %>
        <div class="col-md-2 shadow p-3 ml-5">
          <%= link_to community_path(community) do %>
            <%= image_tag community.get_community_image(150, 150), class:"d-block mx-auto img-thumbnail" %>
            <h4 class="text-center mt-3"><%= community.name %></h4>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>